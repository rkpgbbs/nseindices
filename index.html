<!DOCTYPE html>
<html>
<head>
  <title>NSE Indices Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-4">
    <h1 class="text-center mb-4">NSE Indices Dashboard</h1>
    <div id="loading" class="text-center">Loading data...</div>
    <div class="table-responsive">
      <table class="table table-striped table-hover" id="dataTable">
        <thead class="table-dark"></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    // REPLACE with your actual Web App URL
    const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbyQpQCgkvDZf5AOdsmlr6XuuQS6r0QELzf6nkxvLD3ASnUDt3DGWCOtPMEgjlIrc2R9Kg/exec';
    
    async function loadData() {
      try {
        const response = await fetch(WEB_APP_URL);
        const data = await response.json();
        
        if (data.error) {
          document.getElementById('loading').innerHTML = 'Error: ' + data.error;
          return;
        }
        
        buildTable(data);
      } catch (error) {
        document.getElementById('loading').innerHTML = 'Error loading data';
        console.error(error);
      }
    }

    function buildTable(data) {
      const headers = data[0];
      const rows = data.slice(1);
      
      // Build header
      const headerHTML = '<tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr>';
      document.querySelector('#dataTable thead').innerHTML = headerHTML;
      
      // Build rows
      const rowsHTML = rows.map(row => 
        '<tr>' + row.map(cell => `<td>${cell || ''}</td>`).join('') + '</tr>'
      ).join('');
      document.querySelector('#dataTable tbody').innerHTML = rowsHTML;
      
      document.getElementById('loading').style.display = 'none';
    }

    // Load data when page loads
    window.onload = loadData;
  </script>
</body>
</html>
