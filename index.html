<!DOCTYPE html>
<html>
<head>
  <title>NSE Indices Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container-fluid mt-4">
    <h1 class="text-center mb-4">NSE Indices Performance Dashboard</h1>
    <div id="loading" class="text-center">Loading data...</div>
    <div class="table-responsive">
      <table class="table table-striped" id="dataTable">
        <thead class="table-dark"></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    // REPLACE with your NEW Web App URL (the one that shows data)
    const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycby6CCdFJiPYC6Cfesq2L1bBNKXKwGJTwAgvvcG2GqCkdK-_QLyr0ZDGpo2Ai359xbU14A/exec';
    
    async function loadData() {
      try {
        console.log('Fetching from:', WEB_APP_URL);
        const response = await fetch(WEB_APP_URL);
        const data = await response.json();
        
        console.log('Got data:', data.length, 'rows');
        buildTable(data);
        
      } catch (error) {
        console.error('Error:', error);
        document.getElementById('loading').innerHTML = 'Error: ' + error.message;
      }
    }

    function buildTable(data) {
      if (!data || data.length < 2) {
        document.getElementById('loading').innerHTML = 'No data available';
        return;
      }
      
      const headers = data[0];
      const rows = data.slice(1);
      
      // Build header
      let headerHTML = '<tr>';
      headers.forEach(header => {
        headerHTML += `<th>${header}</th>`;
      });
      headerHTML += '</tr>';
      document.querySelector('#dataTable thead').innerHTML = headerHTML;
      
      // Build rows (show first 20 for testing)
      let rowsHTML = '';
      const displayRows = rows.slice(0, 20);
      displayRows.forEach(row => {
        rowsHTML += '<tr>';
        row.forEach(cell => {
          rowsHTML += `<td>${cell || ''}</td>`;
        });
        rowsHTML += '</tr>';
      });
      
      document.querySelector('#dataTable tbody').innerHTML = rowsHTML;
      document.getElementById('loading').style.display = 'none';
    }

    // Load data when page loads
    window.onload = loadData;
  </script>
</body>
</html>
